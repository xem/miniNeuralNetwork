M=(O,f=1,r)=>Array(O).fill().map((()=>Array(f).fill(r?0:Math.random()-1))),O=(O,f,r,a,l,t,i,g="length")=>{for(6===r&&(a=M(O[g],f[0][g],1)),l=O[g];l--;)for(t=O[0][g];t--;)if(r>5||(O[l][t]=r>3?f(O[l][t]):r>2?O[l][t]*f:r>1?O[l][t]*f[l][t]:r?O[l][t]-f[l][t]:O[l][t]+f[l][t],0))for(i=f[0][g];i--;)a[l][i]+=O[l][t]*f[t][i];return 6===r?a:O},l=.3,f=O=>1/(1+Math.E**-O),g=O=>O*(1-O),i=(O,f,r)=>{w=M(f,O),W=M(r,f),b=M(f),B=M(r)},p=(r,a,l,M)=>{if(M=O(O(O(W,O(O(l=O(w,r,6),b),f,4),6),B),f,4),!a)return M;O(a,M,1),O(W,O(M=O(O(O(M,g,4),a,2),.3,3),[l.flat()],6)),O(B,M),O(w,O(l=O(O(O(l,g,4),O(W[0].map((O=>[O])),a,6),2),.3,3),[r.flat()],6)),O(b,l)}