M=(O,N,r)=>Array(O).fill().map((()=>Array(N).fill(r?0:2*Math.random()-1))),O=(O,N,r,f,l,a,i,t="length")=>{for(0===N&&(f=M(O[0][t],O[t],1)),6===r&&(f=M(O[t],N[0][t],1)),l=O[t];l--;)for(a=O[0][t];a--;)if(6===r||(0===r?O[l][a]+=N[l][a]:1===r?O[l][a]-=N[l][a]:2===r?O[l][a]*=N[l][a]:3===r?O[l][a]*=N:4===r?O[l][a]=N(O[l][a]):0===N&&(f[a][l]=O[l][a]),0))for(i=N[0][t];i--;)f[l][i]+=O[l][a]*N[a][i];return f},N={i:(O,r,f,l=.3,a=O=>1/(1+Math.exp(-O)),i=O=>O*(1-O))=>{N.l=l,N.f=a,N.g=i,N.w=M(r,O),N.W=M(f,r),N.b=M(r,1),N.B=M(f,1)},p:(r,f,M,l)=>{if(O(M=O(N.w,r,6),N.b,0),O(M,N.f,4),O(l=O(N.W,M,6),N.B,0),O(l,N.f,4),!f)return l;O(f,l,1),O(l,N.g,4),O(l,f,2),O(l,N.l,3),O(N.W,O(l,O(M,0),6),0),O(N.B,l,0),O(M,N.g,4),O(M,O(O(N.W,0),f,6),2),O(M,N.l,3),O(N.w,O(M,O(r,0),6),0),O(N.b,M,0)}}