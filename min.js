M=(N,O,f)=>Array(N).fill().map((()=>Array(O).fill(f?0:2*Math.random()-1))),O=(N,O,f,r,l,a,t,i="length")=>{for(6===f&&(r=M(N[i],O[0][i],1)),l=N[i];l--;)for(a=N[0][i];a--;)if(6===f||(N[l][a]=1===f?N[l][a]-O[l][a]:2===f?N[l][a]*O[l][a]:3===f?N[l][a]*O:4===f?O(N[l][a]):N[l][a]+O[l][a],0))for(t=O[0][i];t--;)r[l][t]+=N[l][a]*O[a][t];return r},N={i:(O,f,r,l=.3,a=N=>1/(1+Math.exp(-N)),t=N=>N*(1-N))=>{N.l=l,N.f=a,N.g=t,N.w=M(f,O),N.W=M(r,f),N.b=M(f,1),N.B=M(r,1)},p:(f,r,l,a)=>{if(O(l=O(N.w,f,6),N.b),O(l,N.f,4),O(a=O(N.W,l,6),N.B),O(a,N.f,4),!r)return a;O(r,a,1),O(a,N.g,4),O(a,r,2),O(a,N.l,3),O(N.W,O(a,[l.flat()],6)),O(N.B,a),O(l,N.g,4),O(l,O(N.W[0].map((N=>[N])),r,6),2),O(l,N.l,3),O(N.w,O(l,[f.flat()],6)),O(N.b,l)}}