M=(O,f,r)=>Array(O).fill().map((()=>Array(f).fill(r?0:Math.random()-1))),O=(O,f,r,a,l,t,i,g="length")=>{for(6===r&&(a=M(O[g],f[0][g],1)),l=O[g];l--;)for(t=O[0][g];t--;)if(6===r||(O[l][t]=1===r?O[l][t]-f[l][t]:2===r?O[l][t]*f[l][t]:3===r?O[l][t]*f:4===r?f(O[l][t]):O[l][t]+f[l][t],0))for(i=f[0][g];i--;)a[l][i]+=O[l][t]*f[t][i];return a},l=.3,f=O=>1/(1+Math.E**-O),g=O=>O*(1-O),i=(O,f,r)=>{w=M(f,O),W=M(r,f),b=M(f,1),B=M(r,1)},p=(r,a,l,M)=>{if(O(l=O(w,r,6),b),O(l,f,4),O(M=O(W,l,6),B),O(M,f,4),!a)return M;O(a,M,1),O(M,g,4),O(M,a,2),O(M,.3,3),O(W,O(M,[l.flat()],6)),O(B,M),O(l,g,4),O(l,O(W[0].map((O=>[O])),a,6),2),O(l,.3,3),O(w,O(l,[r.flat()],6)),O(b,l)}