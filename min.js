class a{constructor(a,t){this.data=Array(a).fill().map((()=>Array(t).fill(2*Math.random()-1)))}static fromArray(t){return new a(t.length,1).map(((a,r)=>t[r]))}static S(t,r){return new a(t.data.length,t.data[0].length).map(((a,n,e)=>t.data[n][e]-r.data[n][e]))}A(a){return this.map(((t,r,n)=>t+a.data[r][n]))}static T(t){return new a(t.data[0].length,t.data.length).map(((a,r,n)=>t.data[n][r]))}static D(t,r){return new a(t.data.length,r.data[0].length).map(((a,n,e)=>{let h=0;for(let a=0;a<t.data[0].length;a++)h+=t.data[n][a]*r.data[a][e];return h}))}P(a){return this.map(((t,r,n)=>t*a.data[r][n]))}S(a){return this.map((t=>t*a))}map(a){for(let t=0;t<this.data.length;t++)for(let r=0;r<this.data[0].length;r++){let n=this.data[t][r];this.data[t][r]=a(n,t,r)}return this}static map(t,r){return new a(t.data.length,t.data[0].length).map(((a,n,e)=>r(t.data[n][e],n,e)))}}N={init:(t,r,n,e=.1,h=a=>1/(1+Math.exp(-a)),o=a=>a*(1-a))=>{N.l=e,N.f=h,N.g=o,N.wih=new a(r,t),N.who=new a(n,r),N.bh=new a(r,1),N.bo=new a(n,1)},query:(t,r,n)=>((r=a.D(N.wih,a.fromArray(t))).A(N.bh),r.map(N.f),(n=a.D(N.who,r)).A(N.bo),n.map(N.f),n.data),train:(t,r,n,e,h,o,i,l)=>{n=a.fromArray(t),(e=a.D(N.wih,n)).A(N.bh),e.map(N.f),(h=a.D(N.who,e)).A(N.bo),h.map(N.f),o=a.S(a.fromArray(r),h),i=a.map(h,N.g).P(o).S(N.l),N.who.A(a.D(i,a.T(e))),N.bo.A(i),l=a.map(e,N.g).P(a.D(a.T(N.who),o)).S(N.l),N.wih.A(a.D(l,a.T(n))),N.bh.A(l)}}