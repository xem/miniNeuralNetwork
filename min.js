M=(O,N,r)=>Array(O).fill().map((()=>Array(N).fill(r?0:2*Math.random()-1))),O=(O,N,r,f,l,a,i,t="length")=>{for(5==r&&(f=M(O[0][t],O[t],1)),6==r&&(f=M(O[t],N[0][t],1)),l=O[t];l--;)for(a=O[0][t];a--;)if(0==r&&(O[l][a]+=N[l][a]),1==r&&(O[l][a]-=N[l][a]),2==r&&(O[l][a]*=N[l][a]),3==r&&(O[l][a]*=N),4==r&&(O[l][a]=N(O[l][a])),5==r&&(f[a][l]=O[l][a]),6==r)for(i=N[0][t];i--;)f[l][i]+=O[l][a]*N[a][i];return f},N={i:(O,r,f,l=.3,a=O=>1/(1+Math.exp(-O)),i=O=>O*(1-O))=>{N.l=l,N.f=a,N.g=i,N.w=M(r,O),N.W=M(f,r),N.b=M(r,1),N.B=M(f,1)},p:(r,f,M,l,a)=>{if(M=r,l=O(N.w,M,6),O(l,N.b,0),O(l,N.f,4),a=O(N.W,l,6),O(a,N.B,0),O(a,N.f,4),!f)return a;O(f,a,1),O(a,N.g,4),O(a,f,2),O(a,N.l,3),O(N.W,O(a,O(l,0,5),6),0),O(N.B,a,0),O(l,N.g,4),O(l,O(O(N.W,0,5),f,6),2),O(l,N.l,3),O(N.w,O(l,O(M,0,5),6),0),O(N.b,l,0)}}